<style type="text/css">
	.check_table_user_search_div {
		background-color: #fff;
		margin-left: 1%;
		margin-right: 1%;
		margin-top: 1%;
		margin-bottom: 1%;
		border: 1px solid #a8a3a3;
	}

	.check_table_user_search_div div div {
		margin-top: 20px;
		margin-bottom: 20px;
	}

	.check_table_user_result_div {
		background-color: #fff;
		margin-left: 1%;
		margin-right: 1%;
		margin-top: 1%;
		border: 1px solid #a8a3a3;
	}

	/*个人中心页面*/
	#fund_info_center {
		width: 98%;
		background-color: white;
		height: auto;
		margin-left: 1%;
		margin-top: 2%;
		box-shadow: 1px 1px 5px #535A6C;
		margin-bottom: 23%;
	}

	#fund_info_center ul:first-child span {
		font-size: 30px;
		margin-right: 15px;
		background-color: #535A6C;
		padding: 7px;
		border-radius: 23px;
		color: white;
	}

	.fund_info_input {
		float: right;
		width: 75%;
		padding-left: 0px;
		height: 31px;
		border: 1px solid #c2c2c2;
		margin-right: 15px;
	}

	.fund_info_center ul li label {
		color: #535A6C;
		font-size: 15px;
	}

	.word_spacing {
		letter-spacing: 28px;
	}

	.word_except {
		margin-right: 28px;
	}

	#fund_info_buy_id {
		/* float: right; */
		width: 76%;
	}

	#fund_info_buy_id input {
		margin-right: 5px;
	}

	#fund_info_sell_id input {
		margin-right: 5px;
	}

	.shortselect_add {
		background: #fafdfe;
		height: 28px;
		width: 180px;
		line-height: 28px;
		border: 1px solid #9bc0dd;
		-moz-border-radius: 2px;
		-webkit-border-radius: 2px;
		border-radius: 2px;
	}
	
</style>

<div id="fund_info_center">
	<ul>
		<li style="line-height: 28px;font-size: 16px;color: #535A6C;">
			<span class="glyphicon glyphicon-user" aria-hidden="true" style="font-size: 13px;margin-right: 1px;"></span>新增缓存服务
		</li>
		<li>
			<hr style="border-top: 1px solid #A3ADC6;" />
		</li>
		<li>
			<label class="word_except">缓存IP地址</label>
			<input class="fund_info_input" type="text" id="host" />
		</li>
		<li>
			<label class="word_except">缓存端口</label>
			<input class="fund_info_input" type="text" id="port" />
		</li>
		<li>
			<label class="word_except">缓存db</label>
			<input class="fund_info_input" type="text" id="db" />
		</li>
		<li>
			<label class="word_except">缓存密码</label>
			<input class="fund_info_input" type="text" id="password" placeholder="非必填" />
		</li>
		<li>
			<label class="word_except">内存阈值</label>
			<input class="fund_info_input" type="text" id="memory_threshold" placeholder="非必填" />
		</li>
		<li>
			<label class="word_except">服务备注</label>
			<input class="fund_info_input" type="text" id="note" />
		</li>
		<li>
			<label class="word_except">缓存服务类型</label>
			<label style="float: right;width: 75%;">
				<label><input name="cache_type" type="radio" value=1 />主服务</label>
				<label><input name="cache_type" type="radio" value=2 checked/>缓存节点</label>
			</label>
		</li>
		<li id="master_server_id_li">
			<label class="word_except">对应主服务器</label>
			<label style="float: right;width: 75%;">
				<select name="bbxb" id="master_server_id_add" class="shortselect_add">
				</select>
			</label>
		</li>
		<li>
			<button type="button" class="btn btn-default btn-primary" id="server_info_add" style="margin-left: 16%;">新增</button>
			<label style="color: orangered;"></label>
		</li>
	</ul>
</div>

<script src="others/My97DatePicker/WdatePicker.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	function load_master_server_info() {
		//进入页面后 调用接口 加载 主服务器信息
		$.ajax({
			url: serverUrl_server_info + "master_server_list",
			type: 'get',
			dataType: "json",
			data: {
				token: $.cookie('token')
			},
			success: function(data) {
				if (data.respCode == 200) {
					var result_data = data.result
					$('#master_server_id_add').empty();
					var str_list = []
					for (var i = 0; i < result_data.length; i++) {
						var id = result_data[i]['id'];
						var note = result_data[i]['note'];
						str_list.push('<option value="' + id + '">' + note + '</option>')
					}
					var str = str_list.join("");
					$('#master_server_id_add').append(str);
				} else {
					hide_popover('#master_server_id_add', data.respMsg)
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
				console.log(textStatus)
				hide_popover('#master_server_id_add', '程序错误')
			}
		});
	}
	load_master_server_info()

	function get_mulit_input_val(name) {
		var val_list = new Array();
		$(name).each(function() {
			get_val = $(this).val();
			if (get_val != '') {
				val_list.push(get_val);
			}
		});
		return val_list
	}

	// 新增基金基础信息接口
	$('#server_info_add').on('click', function() {
		var host = $('#host').val();
		var port = $('#port').val();
		var db = $('#db').val();
		var password = $('#password').val();
		var memory_threshold = $('#memory_threshold').val();
		var note = $('#note').val();
		var cache_type = $("[name='cache_type']:checked").val();
		var master_server_id = $('#master_server_id_add').val();

		input_json = {
			port: port,
			host: host,
			db: db,
			password: password,
			memory_threshold: memory_threshold,
			note: note,
			cache_type: cache_type,
		}
		if (host == '' || port == '' || db == '' || note == '' || cache_type == '') {
			alert('请输入必填参数')
			return false
		}
		if (cache_type == 2 && master_server_id == '') {
			alert('请选择 对应主服务器')
		}
		if (cache_type == 2) {
			input_json['master_server_id'] = master_server_id
		}

		//调用接口
		$.ajax({
			url: serverUrl_server_info + "add",
			type: 'post',
			dataType: "json",
			headers: {
				"Content-Type": "application/json;charset=UTF-8",
				"token": $.cookie('token')
			},
			data: JSON.stringify(input_json),
			traditional: true,
			success: function(data) {
				if (data.respCode == 200) {
					hide_popover('#server_info_add', '新增成功')
				} else {
					hide_popover('#server_info_add', data.respMsg)
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
				console.log(textStatus)
				hide_popover('#server_info_add', '程序错误')
			}
		});
	})

	// 单选框 选中触发事件
	$('input:radio[name="cache_type"]').click(function() {
		var checkValue = $('input:radio[name="cache_type"]:checked').val();
		if (checkValue == 2) {
			//缓存节点被选中,显示 对应主服务器
			$('#master_server_id_li').show()
		}else{
			// 不显示 对应服务器
			$('#master_server_id_li').hide()
		}
	});
</script>
